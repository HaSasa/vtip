"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}function getBoxMargin(t,e){if(t){var n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),o=i.width,r=i.height,s=n.width,a=n.height,l=n.top-i.top,c=n.left-i.left,u=n.right-i.left,p=n.bottom-i.top,d=c+s/2,f=l+a/2,m={tl:{x:c,y:l},tr:{x:u,y:l},br:{x:u,y:p},bl:{x:c,y:p}};return{width:s,height:a,margin:{top:{placement:"top",size:l,start:m.tl,mid:{x:d,y:l},end:m.tr},bottom:{placement:"bottom",size:r-p,start:m.bl,mid:{x:d,y:p},end:m.br},left:{placement:"left",size:c,start:m.tl,mid:{x:c,y:f},end:m.bl},right:{placement:"right",size:o-u,start:m.tr,mid:{x:u,y:f},end:m.br}}}}}function getBestPlacement(t){return t.sort(function(t,e){return e.weight-t.weight})[0]}function checkScrollable(t){var e=window.getComputedStyle(t,null);return OVERFLOW_PROPERTYS.some(function(t){return~SCROLL_TYPES.indexOf(e[t])})}function getScrollContainer(t){if(!t)return ROOT;for(var e=t.parentNode;e&&e!==ROOT;){if(checkScrollable(e))return e;e=e.parentNode}return ROOT}function computeCoordinateBaseMid(t,e){var n=t.placement,i=t.mid,o=t.tw,r=t.th;switch(n){case"top":return{placement:"top-mid",x:i.x-o/2,y:i.y-r-e};case"bottom":return{placement:"bottom-mid",x:i.x-o/2,y:i.y+e};case"left":return{placement:"left-mid",x:i.x-o-e,y:i.y-r/2};case"right":return{placement:"right-mid",x:i.x+e,y:i.y-r/2}}}function computeCoordinateBaseEdge(t,e){var n=t.placement,i=t.start,o=t.end,r=t.dHor,s=t.dVer,a=t.tw,l=t.th,c=t.ew,u=t.eh,p=r>0,d=s>0;switch(n){case"top":return{placement:p?"top-end":"top-start",x:p?o.x-a:i.x,y:i.y-l-e,arrowsOffset:c/2};case"bottom":return{placement:p?"bottom-end":"bottom-start",x:p?o.x-a:i.x,y:o.y+e,arrowsOffset:c/2};case"left":return{placement:d?"left-end":"left-start",x:i.x-a-e,y:d?o.y-l:i.y,arrowsOffset:u/2};case"right":return{placement:d?"right-end":"right-start",x:o.x+e,y:d?o.y-l:i.y,arrowsOffset:u/2}}}function computePlacementInfo(t,e,n,i,o){if(t&&n){var r=i&&i.length?i:DEFAULT_PLACEMENT_QUEUE,s=getBoxMargin(t,e),a=s.width,l=s.height,c=s.margin,u=n.getBoundingClientRect(),p=u.width,d=u.height,f=(p-a)/2,m=(d-l)/2,h=r.length,v=Object.keys(c).map(function(t){var e=c[t],n=r.indexOf(e.placement);e.weight=n>-1?MAX-n:MAX-h;var i=~VERTICAL.indexOf(e.placement)&&e.size>d+o,s=i&&c.left.size>f&&c.right.size>f,a=HORIZONTAL.indexOf(e.placement)>-1&&e.size>p+o,l=a&&c.top.size>m&&c.bottom.size>m;return e.dVer=c.top.size-c.bottom.size,e.dHor=c.left.size-c.right.size,e.mod="edge",s||l?(e.mod="mid",e.weight+=3+e.weight/MAX,e):((i||a)&&(e.weight+=2+e.weight/MAX),e)});return Object.assign({ew:a,eh:l,tw:p,th:d,dw:f,dh:m},getBestPlacement(v))}}function computeArrowPos(t,e,n){var i=e+"px",o=e-2*n+"px";return{"top-start":{top:"100%",left:i},"top-mid":{top:"100%",left:"50%"},"top-end":{top:"100%",right:o},"bottom-start":{top:"0",left:i},"bottom-mid":{top:"0",left:"50%"},"bottom-end":{top:"0",right:o},"left-start":{top:i,left:"100%"},"left-mid":{top:"50%",left:"100%"},"left-end":{bottom:o,left:"100%"},"right-start":{top:i,left:"0"},"right-mid":{top:"50%",left:"0"},"right-end":{bottom:o,left:"0"}}[t]}function debounce(t,e){var n=void 0;return function(){var i=this,o=arguments;clearTimeout(n),n=setTimeout(function(){t.apply(i,o)},e)}}function tip(t){return t=t||{},vtipInstance?(Object.assign(vtipInstance,defaultOptions,t),vtipInstance.target?vtipInstance.updateTip():vtipInstance.hiddenTip(),vtipInstance):((vtipInstance=new VtipConstructor({propsData:t}).$mount()).updateTip(),vtipInstance)}function clearEvent(t){t._tipHandler&&(t.removeEventListener("click",t._tipHandler),t.removeEventListener("mouseenter",t._tipHandler)),t._tipMouseleaveHandler&&t.removeEventListener("mouseleave",t._tipMouseleaveHandler),delete t._tipHandler,delete t._tipMouseleaveHandler,delete t._tipOptions,delete t._tipInstance}var Vue=_interopDefault(require("vue")),OVERFLOW_PROPERTYS=["overflow","overflow-x","overflow-y"],SCROLL_TYPES=["scroll","auto"],ROOT=document.body,VERTICAL=["top","bottom"],HORIZONTAL=["left","right"],DEFAULT_PLACEMENT_QUEUE=["top","right","bottom","left"],MAX=4,supportsPassive=!1;document.addEventListener("passive-check",function(){},{get passive(){supportsPassive={passive:!0}}});var main={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"v-tip-fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.tipVisible,expression:"tipVisible"}],staticClass:"v-tip-container",class:t.boxClass,style:t.boxStyle,on:{mouseenter:function(e){t.mouseEntered=!0},mouseleave:function(e){t.mouseEntered=!1}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.placement,expression:"placement"}],staticClass:"v-tip-arrows",class:t.placement,style:t.arrowBox}),t._v(" "),t.title?n("h4",{staticClass:"v-tip-title",domProps:{textContent:t._s(t.title)}}):t._e(),t._v(" "),t.content?n("p",{staticClass:"v-tip-content",style:t.contentHeight,domProps:{textContent:t._s(t.content)}}):t._e(),t._v(" "),t.customComponent?n(t.customComponent,t._g(t._b({tag:"component",on:{hidden:function(e){t.hiddenTip(!0)}}},"component",t.customProps,!1),t.customListeners)):t._e(),t._v(" "),t._t("default")],2)])},staticRenderFns:[],name:"Vtip",props:{title:{type:String,default:""},content:{type:String,default:""},customProps:{type:Object,default:function(){return{}}},customComponent:{type:[String,Function,Object],default:""},customListeners:Object,target:null,container:null,placements:{type:Array,default:function(){return["top","right","bottom","left"]}},duration:{type:Number,default:400},transition:Boolean,arrowsSize:{type:Number,default:8},width:{type:[String,Number],default:"200px"},height:{type:[String,Number],default:"auto"},zIndex:{type:Number,default:999},theme:{type:String,default:"light"},customClass:{type:String,default:""}},data:function(){return this.containerNode=null,this.targetParentNode=null,this.visibleTimer=null,{placement:"",tipVisible:!1,mouseEntered:!1,arrowsPos:{}}},computed:{arrowBox:function(){return Object.assign({borderWidth:this.arrowsSize+"px"},this.arrowsPos)},boxStyle:function(){var t=this.width;return{width:"string"==typeof t?t:t+"px",zIndex:this.zIndex}},boxClass:function(){return[this.customClass,this.theme,this.transition?"transition-transfrom":""]},contentHeight:function(){var t=this.height;return{height:"string"==typeof t?t:t+"px"}}},watch:{mouseEntered:function(t){t||this.setTipDurationVisible(!1)}},beforeDestroy:function(){this.clearScrollEvent()},methods:{showTip:function(){clearTimeout(this.visibleTimer),this.tipVisible=!0},hiddenTip:function(t){t?this.tipVisible=!1:this.setTipDurationVisible(!1)},updateTip:function(){this.setContainerNode(),this.showTip(),this.asynSetCoordinate()},setContainerNode:function(){var t=this.$el,e=this.target,n=this.container,i=this.targetParentNode,o=this.containerNode;if(e&&e.parentNode!==i){this.targetParentNode=e.parentNode;var r=n||getScrollContainer(e);if(r!==o){t.parentNode!==r&&r.appendChild(t);var s=window.getComputedStyle(r,null).position;s&&"static"!==s||(r.style.position="relative"),o&&o.removeEventListener("scroll",this.scrollHandler,supportsPassive),checkScrollable(r)&&r.addEventListener("scroll",this.scrollHandler,supportsPassive),this.containerNode=r}}},setCoordinate:function(){var t=this.$el,e=this.target,n=this.containerNode,i=this.placements,o=this.arrowsSize;if(t&&e&&n){var r=computePlacementInfo(e,n,t,i,o),s="mid"===r.mod?computeCoordinateBaseMid(r,o):computeCoordinateBaseEdge(r,o);this.setArrowsPos(s),this.placement=s.placement;var a=s.x+n.scrollLeft,l=s.y+n.scrollTop;this.$el.style.transform="translate3d("+a+"px, "+l+"px, 0)"}},asynSetCoordinate:function(){this.$nextTick(this.setCoordinate)},setArrowsPos:function(t){var e=t.placement,n=t.arrowsOffset;this.arrowsPos=computeArrowPos(e,n,this.arrowsSize)},setTipDurationVisible:function(t){var e=this;null==this.duration||this.duration<=0||(clearTimeout(this.visibleTimer),this.visibleTimer=setTimeout(function(){e.tipVisible=t||e.mouseEntered,e.visibleTimer=null},this.duration))},scrollHandler:debounce(function(){this.setCoordinate()},200),clearScrollEvent:function(){this.containerNode&&this.containerNode.removeEventListener("scroll",this.scrollHandler,supportsPassive)}}},VtipConstructor=Vue.extend(main),props=main.props,defaultOptions={};Object.keys(props).forEach(function(t){var e=props[t],n=e.default;e&&null!=e.default&&(defaultOptions[t]="function"==typeof n?n():n)});var vtipInstance=null,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},asyncGenerator=function(){function t(t){this.value=t}function e(e){function n(o,r){try{var s=e[o](r),a=s.value;a instanceof t?Promise.resolve(a.value).then(function(t){n("next",t)},function(t){n("throw",t)}):i(s.done?"return":"normal",s.value)}catch(t){i("throw",t)}}function i(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}(o=o.next)?n(o.key,o.arg):r=null}var o,r;this._invoke=function(t,e){return new Promise(function(i,s){var a={key:t,arg:e,resolve:i,reject:s,next:null};r?r=r.next=a:(o=r=a,n(t,e))})},"function"!=typeof e.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)},{wrap:function(t){return function(){return new e(t.apply(this,arguments))}},await:function(e){return new t(e)}}}(),directive={install:function(t,e){var n=(e=e||{}).directiveName||"tip",i=["top","right","bottom","left"];t.directive(n,{bind:function(t,e){clearEvent(t);var n=e.modifiers,o=n.click,r=n.dark,s=n.transition,a=i.filter(function(t){return e.modifiers[t]});t._tipOptions=e.value,t._tipHandler=function(){if(null!=this._tipOptions){var t=this._tipOptions,e={placementQueue:a.length?a:i,transition:s,theme:r?"dark":"light"},n="object"===(void 0===t?"undefined":_typeof(t))?Object.assign(e,t,{target:this}):Object.assign(e,{content:String(t),target:this});this._tipInstance=tip(n)}},t._tipMouseleaveHandler=function(){this._tipInstance&&this._tipInstance.hiddenTip()},o?t.addEventListener("click",t._tipHandler):t.addEventListener("mouseenter",t._tipHandler),t.addEventListener("mouseleave",t._tipMouseleaveHandler)},update:function(t,e){var n=e.value;n!==e.oldValue&&(t._tipOptions=n)},unbind:function(t){var e=t._tipInstance;e&&e.clearScrollEvent&&e.clearScrollEvent(),clearEvent(t)}})}},index={tip:tip,directive:directive};module.exports=index;
